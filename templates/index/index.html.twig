{% extends 'base.html.twig' %}

{% block title %}ComparteCoche{% endblock %}
{% block stylesheets %}    
    <!-- avatars -->
    <link href="/css/avatars.css" rel="stylesheet">
{% endblock %}

{% block body %}
<section class="hero is-link">
    <div class="hero-body">
        <p class="title">
            {{ grupo }}
        </p>
        <p class="subtitle">
            {{ grupo.description }}
        </p>
        <div class="hero-avatar">
            <section class="avatars">
                <img class="avatar" src="/images/avatars/{{ app.user.avatar }}" alt="{{ app.user.userIdentifier }}">
            </section>
        </div>
    </div>
</section>
<div class="container is-fluid mt-4">
    <div class="tile is-ancestor">
        <div class="tile">
        <div class="tile is-8 is-vertical">
            <div class="tile is-parent is-vertical">
                <article class="tile is-child notification is-danger">
                    <p class="title">Tus Viajes</p>
                    <p class="subtitle">Existen {{ trayectos|length }} trayectos</p>
                    <div class="content">
                        <table class="table is-success is-striped">
                            <thead>
                                <tr>
                                <th scope="col">Fecha</th>
                                <th scope="col">Inicio</th>
                                <th scope="col">Fin</th>
                                <th scope="col">F</th>
                                </tr>
                            </thead>
                            <tbody>                            
                            {% for trayecto in trayectos %}                            
                                <tr>
                                    <th scope="row">                                        
                                        {{ trayecto.dateTrayecto | format_datetime('short', 'none', locale='fr') }}
                                    </th>
                                    <td>
                                        {{ trayecto.timeAt | format_time(pattern='HH:mm') }}
                                    </td>
                                    <td>
                                        {{ trayecto.timeTo | format_time(pattern='HH:mm') }}
                                    </td>
                                    <td>                                        
                                        {% if trayecto.passenger is null %}
                                            <i class="fa fa-question is-danger"></i>
                                        {% elseif trayecto.passenger == false %}
                                            <i class="fa fa-automobile is-primary"></i>
                                        {% else %}
                                            <i class="fa fa-user is-success"></i>
                                        {% endif %}
                                    </td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                        <nav class="pagination" role="navigation" aria-label="pagination">
                            {% if previous >= 0 %}
                                <a class="pagination-previous" href="{{ path('homepage', { offset:previous }) }}">Previous</a>
                            {% else %}
                                <a class="pagination-previous" disabled href="#">Previous</a>
                            {% endif %}
                            {% if next < trayectos|length %}
                                <a class="pagination-next" href="{{ path('homepage', { offset: next}) }}">Next page</a>
                            {% else %}
                                <a class="pagination-next" href="#" disabled>Next page</a>
                            {% endif %}
                        </nav>
                    </div>
                </article>
            </div>
            <div class="tile is-parent is-vertical">
                <article class="tile is-child notification is-primary">
                    <p class="title">Trayectos Próximos</p>
                    <p class="subtitle">Existen {{ disponibles|length }} trayectos</p>
                    <div class="container">
                        {% for trayectos in disponibles %}                            
                                <nav class="level has-background-warning px-3 py-2">
                                    <div class="level-left">
                                        <div class="level-item">
                                            <div class="control">
                                                <button id="submitButton" onclick='location.href = "{{ path('app_trayecto', {id: trayectos.id}) }}"' class="button is-link">
                                                    {{ trayectos.date_trayecto | format_datetime('short', 'none', locale='fr') }}
                                                </button>
                                                <span class="tag is-danger">
                                                    {{ trayectos.time_at | format_time(pattern='HH:mm') }}
                                                </span>
                                                <span class="tag is-danger">
                                                    {{ trayectos.time_to | format_time(pattern='HH:mm') }}
                                                </span>
                                            </div>
                                        </div>
                                        <div class="level-item">
                                            <span class="avatars">
                                            {% for users in trayectos["drivers"] %}
                                                {% if users.avatar %}
                                                    <img class="avatar" src="/images/avatars/{{ users.avatar }}" alt="{{ users.email }}">
                                                {% else %}
                                                    <img class="avatar" src="/images/avatars/default.png" alt="{{ users.email }}">
                                                {% endif %}
                                            {% endfor %}
                                            </span>
                                        </div>
                                    </div>
                                    <div class="level-right">
                                        <!-- -->
                                    </div>
                                </nav>                            
                        {% endfor %}
                    </div>
                </article>
            </div>
        </div>
        <div class="tile">
            <div class="tile is-parent">
                <article class="tile is-child notification is-warning">
                    <p class="title">Acciones</p>
                    <p class="subtitle">Seleccione alguna opción</p>
                    <div class="content">
                        <div class="buttons">
                            <button class="button is-link" onclick="location.href='{{ path('app_newTime') }}'">Nuevo Horario</button>
                        </div>                        
                    </div>
                </article>
            </div>
        </div>
    </div>
</div>
{% endblock %}
